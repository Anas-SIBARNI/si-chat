.app-container {
   height: 100vh;
   width: 100%;
   display: grid;
   grid-template-columns: var(--sidebar-w) var(--contacts-w) 1fr var(--profile-w);
   grid-template-rows: 100%;
   position: relative;       /* nécessaire pour gérer les z-index enfants */
   overflow: hidden;         /* évite les scrollbars globales */
 }
 
 /* colonnes latérales (facteur commun) */
 .sidebar,
 .contacts,
 .profile {
   background: var(--panel);
   border-color: var(--border);
   min-width: 0;             /* évite les débordements de contenu */
   overflow-y: auto;         /* chaque colonne scrolle dans sa zone */
 }
 
 /* placement + séparateurs */
 .sidebar  { grid-column: 1; grid-row: 1; border-right: 1px solid var(--border); z-index: 2; }
 .contacts { grid-column: 2; grid-row: 1; border-right: 1px solid var(--border); z-index: 1; }
 .profile  { grid-column: 4; grid-row: 1; border-left:  1px solid var(--border); z-index: 1; }
 .chat {
   grid-column: 3;
   grid-row: 1;
   background: var(--bg);
   display: grid;
   grid-template-rows: var(--header-h) 1fr var(--footer-h);
   min-width: 0;             /* important pour que le flux texte ne force pas la largeur */
   z-index: 0;
 }
 
 /* header/footer collants dans la zone chat (sans changer les couleurs) */
 .chat > .chat-header {
   position: sticky;
   top: 0;
   z-index: 3;
   backdrop-filter: saturate(180%) blur(6px); /* léger effet verre teinté */
 }
 
 .chat > .chat-footer {
   position: sticky;
   bottom: 0;
   z-index: 3;
   backdrop-filter: saturate(180%) blur(6px);
 }
 
 /* la partie messages (le centre) scrolle proprement */
 .chat > .chat-body {
   overflow-y: auto;
   min-height: 0; /* évite l’étirement qui casse le scroll */
 }
 
 /* optionnel : scrollbar discrète (ne touche pas à la palette) */
 .sidebar::-webkit-scrollbar,
 .contacts::-webkit-scrollbar,
 .profile::-webkit-scrollbar,
 .chat > .chat-body::-webkit-scrollbar {
   width: 8px;
   height: 8px;
 }
 .sidebar::-webkit-scrollbar-thumb,
 .contacts::-webkit-scrollbar-thumb,
 .profile::-webkit-scrollbar-thumb,
 .chat > .chat-body::-webkit-scrollbar-thumb {
   background: rgba(255,255,255,0.12);
   border-radius: 8px;
 }
 


/* ===== Responsive layout - si-chat ===== */

/* ≤ 1200px : on “cache” la colonne profil ou la passe en off-canvas */
@media (max-width: 1200px) {
  :root{
    --profile-w: 0px;
  }
  .profile { display: none; }
  .app-container {
    grid-template-columns: var(--sidebar-w) var(--contacts-w) 1fr 0;
  }
}

/* ≤ 992px : on compresse la barre latérale et les contacts */
@media (max-width: 992px) {
  :root{
    --sidebar-w: 72px;
    --contacts-w: 220px;
  }
}

/* ≤ 768px : vue “mobile” = 1 colonne (chat), panneaux en tiroirs */
@media (max-width: 768px) {
  .app-container {
    grid-template-columns: 1fr;
    overflow: hidden;
  }

  /* Panneaux latéraux en off-canvas */
  .sidebar,
  .contacts,
  .profile{
    position: fixed;
    top: 0; bottom: 0;
    width: min(86vw, 360px);
    max-width: 86vw;
    z-index: 50;
    border-right: 1px solid var(--sb-border, rgba(255,255,255,.12));
    background: var(--panel, rgba(30,41,59,.9));
    backdrop-filter: blur(6px);
    transition: transform .25s ease;
  }
  .sidebar   { left: 0;  transform: translateX(-100%); }
  .contacts  { left: 0;  transform: translateX(-100%); }
  .profile   { right: 0; transform: translateX(100%);  border-left: 1px solid var(--sb-border, rgba(255,255,255,.12)); }

  /* Modifiers pour ouvrir (tu les toggles en JS via .is-open) */
  .sidebar.is-open  { transform: translateX(0); }
  .contacts.is-open { transform: translateX(0); }
  .profile.is-open  { transform: translateX(0); }

  /* La zone chat prend tout l’écran */
  .chat {
    grid-column: 1 / -1;
    height: 100vh;
  }

  /* Corps du chat: calc hauteur avec header + composer */
  .chat > .chat-header { position: sticky; top: 0; z-index: 5; }
  .chat > .chat-body   { 
    height: calc(100vh - var(--header-h, 64px) - var(--footer-h, 74px));
    overflow-y: auto;
  }
  .chat > .chat-composer { 
    position: sticky; bottom: 0; z-index: 5;
  }
}

/* ≥ 769px : on force tout à redev. visible inline (sécurité retour desktop) */
@media (min-width: 769px) {
  .sidebar, .contacts, .profile {
    position: static; transform: none; width: auto; max-width: none;
    border: none; z-index: auto; backdrop-filter: blur(5px);
  }
  .profile { display: block; }
}
